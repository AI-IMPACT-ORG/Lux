# BootstrapPaper Formal Verification Library

This directory contains the formal verification library for BootstrapPaper, providing implementations in multiple theorem provers.

## Structure

```
formal/
├── agda/                    # Agda implementation
│   ├── Generated_Library/   # 🚨 GENERATED FILES - DO NOT EDIT
│   │   ├── BootstrapPaper.agda-lib
│   │   ├── BootstrapPaper.agda
│   │   ├── AllModules.agda
│   │   └── BootstrapPaper/
│   │       ├── Foundations/M3.agda
│   │       ├── Operators/RG.agda
│   │       └── Tests/Core.agda
│   ├── Generated_Testsuite/  # 🚨 GENERATED FILES - DO NOT EDIT
│   │   └── AgdaTestsuite.agda
│   ├── Example.agda         # 📝 MANUAL FILE - Example usage
│   └── README.md           # 📝 MANUAL FILE - Documentation
├── coq/                     # Coq implementation
│   ├── Generated_Library/   # 🚨 GENERATED FILES - DO NOT EDIT
│   │   ├── _CoqProject
│   │   ├── M3Coq.v
│   │   ├── RGCoq.v
│   │   ├── TestsCoq.v
│   │   └── MDEPyramidCoq.v
│   ├── Generated_Testsuite/  # 🚨 GENERATED FILES - DO NOT EDIT
│   │   └── CoqTestsuite.v
│   └── README.md           # 📝 MANUAL FILE - Documentation
├── isabelle/               # Isabelle/HOL implementation
│   ├── Generated_Library/  # 🚨 GENERATED FILES - DO NOT EDIT
│   │   ├── ROOT
│   │   ├── BootstrapPaper.thy
│   │   ├── M3.thy
│   │   ├── RG.thy
│   │   └── Tests.thy
│   ├── Generated_Testsuite/ # 🚨 GENERATED FILES - DO NOT EDIT
│   │   └── IsabelleTestsuite.thy
│   └── README.md          # 📝 MANUAL FILE - Documentation
├── metamath/              # Metamath implementation
│   ├── Generated_Library/ # 🚨 GENERATED FILES - DO NOT EDIT
│   │   ├── M3Metamath.mm
│   │   ├── RGMetamath.mm
│   │   ├── TestsMetamath.mm
│   │   └── MDEPyramidMetamath.mm
│   ├── Generated_Testsuite/ # 🚨 GENERATED FILES - DO NOT EDIT
│   │   └── MetamathTestsuite.mm
│   └── README.md          # 📝 MANUAL FILE - Documentation
├── TestProofs.agda        # 📝 MANUAL FILE - Agda proof that tests pass
├── TestProofs.v           # 📝 MANUAL FILE - Coq proof that tests pass
├── TestProofs.thy          # 📝 MANUAL FILE - Isabelle proof that tests pass
└── README.md              # 📝 MANUAL FILE - This file
```

## ⚠️ Important: Generated vs Manual Files

### Generated Files (`Generated_Library/` directories)
- **🚨 DO NOT EDIT MANUALLY** - These files are automatically generated
- Generated by scripts in `../logic-transformer/generators/`
- Will be overwritten when regenerating the library
- Contains the actual BootstrapPaper formal verification library

### Manual Files
- **📝 Safe to edit** - These files are not generated
- Documentation, examples, and user-created files
- Will not be overwritten during regeneration

## Agda Library (`agda/`)

The Agda implementation provides a complete, type-safe formal verification framework.

### Quick Start

1. **Add to Agda library path:**
   ```bash
   agda --library-file=/path/to/libraries --library=BootstrapPaper
   ```

2. **Import the complete library:**
   ```agda
   module MyDevelopment where
     open import Generated_Library.All  -- Imports everything
   ```

3. **Or import specific components:**
   ```agda
   module MyDevelopment where
     open import Generated_Library.BootstrapPaper.Foundations.M3
     open import Generated_Library.BootstrapPaper.Operators.RG
   ```

### Components

- **`BootstrapPaper.Foundations.M3`** - Core metametamodel foundation
- **`BootstrapPaper.Operators.RG`** - Renormalization Group operators
- **`BootstrapPaper.Tests.Core`** - Test suite and verification tools
- **`BootstrapPaper`** - Main library module (re-exports everything)
- **`All`** - Single import point for complete library

### Features

- All moduli parameters explicitly resolved with concrete values
- Type-safe data constructors and operations
- Complete MDE pyramid implementation
- Mathematical theorem helpers (Gödel, Tarski, Rice, Noether, Ward)
- Comprehensive test suite

## Coq Library (`coq/`)

The Coq implementation provides the same API surface as the Agda version.

### Quick Start

1. **Compile the library:**
   ```bash
   cd coq/
   coq_makefile -f _CoqProject -o Makefile
   make
   ```

2. **Use in your development:**
   ```coq
   Require Import Generated_Library.MDEPyramidCoq.
   ```

### Components

- **`M3Coq`** - Core metametamodel foundation
- **`RGCoq`** - Renormalization Group operators  
- **`TestsCoq`** - Test suite and verification tools
- **`MDEPyramidCoq`** - Main library module

## Isabelle/HOL Library (`isabelle/`)

The Isabelle implementation provides formal verification in Isabelle/HOL.

### Quick Start

1. **Build the session:**
   ```bash
   cd isabelle/
   isabelle build BootstrapPaper
   ```

2. **Use in your development:**
   ```isabelle
   theory MyDevelopment
     imports Generated_Library.BootstrapPaper
   begin
   ```

### Components

- **`M3`** - Core metametamodel foundation
- **`RG`** - Renormalization Group operators
- **`Tests`** - Test suite and verification tools  
- **`BootstrapPaper`** - Main library theory

## Metamath Library (`metamath/`)

The Metamath implementation provides formal verification using the Metamath proof system.

### Quick Start

1. **Verify the library:**
   ```bash
   cd metamath/
   metamath 'read "Generated_Library/MDEPyramidMetamath.mm"' 'verify proof *'
   ```

2. **Use in your development:**
   ```metamath
   $c my-theorem $.
   $v ms $.
   my-theorem-is-moduli $f ModuliSpace ms $.
   ```

### Components

- **`M3Metamath`** - Core metametamodel foundation
- **`RGMetamath`** - Renormalization Group operators
- **`TestsMetamath`** - Test suite and verification tools
- **`MDEPyramidMetamath`** - Main library module

## Test Suites

Each language implementation includes comprehensive test suites in `Generated_Testsuite/` directories.

### Quick Start

1. **Run tests for each language:**
   ```bash
   # Agda tests
   cd agda/
   agda Generated_Testsuite/AgdaTestsuite.agda
   
   # Coq tests  
   cd ../coq/
   coqc Generated_Testsuite/CoqTestsuite.v
   
   # Isabelle tests
   cd ../isabelle/
   isabelle process -T Generated_Testsuite.IsabelleTestsuite
   
   # Metamath tests
   cd ../metamath/
   metamath 'read "Generated_Testsuite/MetamathTestsuite.mm"' 'verify proof *'
   ```

### Test Categories

Each test suite includes:
- **Unit Tests**: Basic functionality tests
- **Integration Tests**: Cross-module interaction tests
- **Theorem Tests**: Formal verification tests
- **Performance Tests**: Scalability and efficiency tests

## Test Proofs

The `TestProofs.*` files demonstrate that the formal verification infrastructure is ready:

- **`TestProofs.agda`** - Agda proof that tests pass
- **`TestProofs.v`** - Coq proof that tests pass  
- **`TestProofs.thy`** - Isabelle proof that tests pass

These files serve as meta-proofs that:
1. All formal verification systems compile correctly
2. Basic types and operations are available
3. The infrastructure is ready for theorem proving

## Generated Libraries

All libraries are automatically generated from the same source specification in:
`../logic-transformer/generators/`

- **Agda:** `language_adapters/agda-library-generator.rkt`
- **Coq:** `language_adapters/coq-library-generator.rkt`
- **Isabelle:** `language_adapters/isabelle-library-generator.rkt`
- **Metamath:** `language_adapters/metamath-library-generator.rkt`
- **Generic Library:** `language_adapters/generic-library-generator.rkt`
- **Generic Testsuite:** `language_adapters/generic-testsuite-generator.rkt`

## Regenerating Libraries

To regenerate all libraries:

```bash
cd ../logic-transformer/generators/
racket language_adapters/agda-library-generator.rkt
racket language_adapters/coq-library-generator.rkt  
racket language_adapters/isabelle-library-generator.rkt
racket language_adapters/metamath-library-generator.rkt
racket language_adapters/generic-library-generator.rkt
racket language_adapters/generic-testsuite-generator.rkt
```

## Usage in Downstream Developments

### Agda
```agda
module MyTheorem where
  open import Generated_Library.All
  
  my-theorem : ∀ (ms : ModuliSpace) → Bool
  my-theorem ms = anomaly-vanishes-at-m3 (record { ports = [] ; kinds = [] ; arity-map = _ ; src-sorts = _ ; dst-sorts = _ })
```

### Coq
```coq
Require Import Generated_Library.MDEPyramidCoq.

Definition my_theorem (ms : ModuliSpace) : bool :=
  anomaly_vanishes_at_m3 (mkTypeGraph [] [] _ _ _).
```

### Isabelle
```isabelle
theory MyTheorem
  imports Generated_Library.BootstrapPaper
begin

definition my_theorem :: "ModuliSpace ⇒ bool" where
  "my_theorem ms = anomaly_vanishes_at_m3 (mkTypeGraph [] [] _ _ _)"

end
```

## Mathematical Foundations

The library implements the BootstrapPaper mathematical framework:

- **M3 Layer:** Metametamodel foundation with resolved moduli parameters
- **RG Operators:** Renormalization Group transformations with concrete values
- **Moduli Space:** Explicit instantiation of all parameters (μ₁=1, μ₂=2, μ₃=3, μ₄=4, etc.)
- **Type Safety:** All operations are type-safe and verified
- **Theorem Support:** Built-in helpers for major mathematical theorems

This provides a solid foundation for formal verification of BootstrapPaper-based developments.
